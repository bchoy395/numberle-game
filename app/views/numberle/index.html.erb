<div class="container">
  <div class="card shadow">
    <div id="scroll-container" class="card-body text-center my-4" style="max-height: 80vh;">
      <h2 class="card-title mb-4">Numberle 🔢</h2>
      <p class="d-none">The answer is: <%= session[:answer] %></p>

      <turbo-frame id="numberle-frame">
        <% session[:guesses].each do |guess| %>
          <div class="row justify-content-center">
            <% guess["feedback"].each_with_index do |feedback, i| %>
              <%= text_field_tag nil, guess["value"][i],
                class: "numberle-cell form-control guess-#{feedback || "gray"}",
                disabled: true
              %>
            <% end %>
          </div>
        <% end %>

        <% if @guess == session[:answer] %>
          <div class="row">
            <div class="col-12">
              <h3 class="text-success m-3">🎉 You did it! 🎉</h3>
              <%= link_to "Play again", root_path, class: "btn btn-success rounded-0" %>
            </div>
          </div>
        <% else %>
          <%= form_with url: guess_numberle_path, data: { controller: "numberle" } do %>
            <div class="row justify-content-center mb-3">
              <% 8.times do |i| %>
                <%= number_field_tag "guess[]", nil,
                  autofocus: (i == 0),
                  autocomplete: "off",
                  class: "numberle-cell form-control border-dark-subtle",
                  data: { numberle_target: "guess", action: "keydown->numberle#handleKeydown" }
                %>
              <% end %>
            </div>
            <div class="row">
              <div class="col-12">
                <%= submit_tag "Guess", class: "btn btn-success rounded-0" %>
              </div>
            </div>
          <% end %>
        <% end %>
      </turbo-frame>
    </div>

    <div class="card-footer text-center text-muted">
      Made with ❤️ by Lily Brooks (Bribri)
    </div>
  </div>
</div>
